# Crontab jobs used by the MARSfarm mini
# Author: Howard Webb
# Date: 11/13/2017
# Warning: This will overwrite any existing crontab, do not use if you use cron for other purposes

#Modified by: Jackie Zhong(zy99120@gmail.com)
#Modified by: Tyler Richards(richardstylerj20@gmail.com)
#Modified by: Peter Webb(peter@marsfarm.com) - 07.28.22 & 11.01.22
#Modified by: Howard Webb(webb.howard.m@gmail.com) - 11.10.22
#Modified by: Peter Webb - 11.11.22

# Don't send email
MAILTO=""


PYTHON_PATH=/home/pi/Desktop/MV1_firmware/python
SCRIPT_PATH=/home/pi/Desktop/MV1_firmware/scripts
LOG_PATH=/home/pi/Desktop/MV1_firmware/logs
 
# m h  dom mon dow   command      
# 2>&1 send standard output to errors  
# use > to add to top of file >> to add to bottom of file

# Capture camera using white lights, every hour, five minutes after the hour
5 * * * * python3 $PYTHON_PATH/CameraAF.py >> $LOG_PATH/Webcam.log 2>&1 &

# Upload most recent image to amazon S3, every hour, ten minutes after the hour
10 * * * * $SCRIPT_PATH/S3.sh > $LOG_PATH/S3.log 2>&1 &

# Capture temperature, humidity, and Co2 sensor data, send it to MongoDB and Google Sheets, every hour, 2 minutes after the hour
2 * * * * python3 $PYTHON_PATH/LogSensors.py >> $LOG_PATH/LogSensor.log 2>&1 &

# Check trial settings, to determine LED channel values, every minute
* * * * * python3 $PYTHON_PATH/Light_Control.py >> $LOG_PATH/Light.log 2>&1 &

# Check trial settings and pump status, to determine pump status, every minute
* * * * * python3 $PYTHON_PATH/Pump_Control.py >> $LOG_PATH/Pump.log 2>&1 &

# Check trial settings and temperature values, to determine whether heater or exhaust fan turns on, every 10 seconds
* * * * * for i in {1..5}; do python3 $PYTHON_PATH/Thermostat.py & sleep 10; done >> $LOG_PATH/Thermostat.log 2>&1 &

# Start pigpio service, at reboot
@reboot sleep 60; sudo pigpiod >> $LOG_PATH/boot.log 2>&1 &

# Set up MAC address to remain static, at reboot
@reboot sleep 60; sudo ifconfig eth0 down; sudo macchanger --mac=66:d0:72:62:31:25 eth0; sudo ifconfig eth0 up >> $CRON_LOG 2>&1

# Start paho service to listen for device_id on MQTT server, continues to loop after starting at reboot
@reboot sleep 240; python3 $PY_PATH/pythonmqttsub_savetrial.py >> $CRON_LOG 2>&1


